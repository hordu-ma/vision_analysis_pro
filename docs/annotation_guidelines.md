# 基础设施图像标注规范

本文档定义了工程基础设施（桥梁、建筑、道路等）图像标注的类目、规则和质量标准，用于指导标注团队和训练 YOLO 目标检测模型。

---

## 📋 版本信息

- **版本**: v1.0
- **生效日期**: 2025-12-17
- **维护人**: Vision Analysis Pro Team
- **变更记录**: 
  - v1.0 (2025-12-17): 初始版本，定义 5 个核心类别

---

## 🎯 类目定义

### 核心类别（5 类）

| ID  | 类别名称 | 英文标签 | 颜色代码 | 描述 | 严重等级 |
|-----|---------|---------|---------|------|---------|
| 0   | 裂缝    | crack   | 红色 #FF0000 | 结构表面的线性或网状裂纹 | 高 |
| 1   | 锈蚀    | rust    | 橙色 #FF8800 | 金属构件表面的氧化锈蚀 | 中 |
| 2   | 变形    | deformation | 黄色 #FFFF00 | 构件弯曲、扭曲等形变 | 高 |
| 3   | 剥落    | spalling | 紫色 #8800FF | 混凝土保护层剥离脱落 | 中 |
| 4   | 腐蚀    | corrosion | 青色 #00FFFF | 化学腐蚀导致的材料损坏 | 中 |

### 类别详细说明

#### 1. crack（裂缝）
- **典型特征**：
  - 线性或树状分布的缝隙
  - 宽度范围：0.1mm - 10mm+
  - 长度：通常 > 5cm
- **标注要点**：
  - 包含整个裂缝的可见范围
  - 多条裂缝需分别标注
  - 细微裂缝（< 0.3mm）可选择性标注
- **难例处理**：
  - 裂缝与污渍混淆 → 看是否有连续性和深度
  - 表面纹理 vs 真实裂缝 → 放大确认是否为实际缝隙

#### 2. rust（锈蚀）
- **典型特征**：
  - 橙黄色或棕色斑块
  - 出现在钢筋、钢结构、金属连接件
  - 表面粗糙不均
- **标注要点**：
  - 框选锈蚀区域的外轮廓
  - 多处锈蚀需分别标注
  - 仅表面轻微变色（无腐蚀）不标注
- **难例处理**：
  - 泥土污渍 vs 锈蚀 → 根据位置（金属构件）判断
  - 油漆剥落露出底漆 → 非锈蚀，不标注

#### 3. deformation（变形）
- **典型特征**：
  - 梁柱弯曲、扭曲
  - 板面不平、起拱
  - 金属构件扭曲变形
- **标注要点**：
  - 框选变形构件的明显区域
  - 整体倾斜不算变形（除非局部明显弯曲）
  - 需与原设计有明显偏差
- **难例处理**：
  - 设计曲线 vs 病害变形 → 参考周边结构，判断是否异常
  - 拍摄角度导致的视觉畸变 → 多角度确认

#### 4. spalling（剥落）
- **典型特征**：
  - 混凝土保护层脱落
  - 露出内部钢筋或骨料
  - 边缘不规则，深度明显
- **标注要点**：
  - 框选剥落区域及周边松动部分
  - 表面风化（浅层）与剥落（深层）区分
  - 剥落深度 > 5mm 才标注
- **难例处理**：
  - 剥落 vs 人为凿除 → 根据边缘形态判断（剥落边缘不规则）
  - 表面粉化 vs 剥落 → 剥落有明显深度和钢筋外露

#### 5. corrosion（腐蚀）
- **典型特征**：
  - 化学腐蚀导致的材料损伤
  - 表面坑洞、溶蚀痕迹
  - 常见于污染环境或化学接触区域
- **标注要点**：
  - 框选腐蚀区域的完整范围
  - 与锈蚀区分：腐蚀有明显的材料流失
  - 表面变色但无材料损失 → 不标注
- **难例处理**：
  - 腐蚀 vs 锈蚀 → 腐蚀有坑洞，锈蚀为表面氧化
  - 风化 vs 腐蚀 → 腐蚀通常有化学反应痕迹

---

## 📐 标注规则

### 1. 边界框（Bounding Box）规则

#### 基本原则
- **紧贴原则**：bbox 边缘应紧贴目标的可见边界，留白 < 5%
- **完整性原则**：包含病害的完整范围，不截断关键特征
- **最小面积**：bbox 面积应 > 32x32 像素（过小目标不标注）
- **最大面积**：单个 bbox 面积 < 图像面积的 80%（超大目标拆分）

#### 特殊情况处理
- **遮挡**：被遮挡 > 50% 的目标不标注
- **边缘截断**：目标在图像边缘被截断，标注可见部分
- **重叠**：多个病害重叠时，按主要病害类型标注
- **群体**：密集分布的同类病害可合并为一个大框（如密集裂缝网）

### 2. 标注质量标准

#### IoU 阈值
- **优秀**：与真实边界 IoU ≥ 0.85
- **合格**：IoU ≥ 0.70
- **不合格**：IoU < 0.70（需重新标注）

#### 一致性要求
- 同一标注员对相似目标的标注偏差 < 10%
- 不同标注员的标注 IoU ≥ 0.75（通过审核）

### 3. 难例处理策略

#### 边界模糊
- **策略**：采用"从严原则"，框选明显病害区域，边界模糊部分不包含
- **示例**：裂缝边缘有细微分支 → 仅标注主裂缝

#### 类别歧义
- **策略**：按主要特征判断，必要时咨询工程师
- **示例**：锈蚀 + 剥落共存 → 标注为 spalling（更严重）

#### 微小目标
- **策略**：宽度/高度 < 10 像素的目标，标注时适当放大 bbox 至 16x16
- **示例**：细裂缝标注时确保宽度 ≥ 16 像素

#### 光线/角度问题
- **策略**：低质量图像（模糊、过曝、逆光）可选择性跳过
- **判断标准**：人眼无法清晰识别 → 不标注

---

## 🖼️ 样例参考

### 正例（Good Examples）
每个类别提供 3-5 张标注正确的示例图，见 `data/samples/good/`：
- `crack_001.jpg` - 标准裂缝标注
- `rust_001.jpg` - 标准锈蚀标注
- `deformation_001.jpg` - 标准变形标注
- 等

### 边界案例（Edge Cases）
提供容易混淆的边界案例，见 `data/samples/edge/`：
- `crack_vs_texture.jpg` - 裂缝 vs 表面纹理
- `rust_vs_dirt.jpg` - 锈蚀 vs 泥土污渍
- `spalling_vs_weathering.jpg` - 剥落 vs 风化
- 等

### 负例（Negative Examples）
不应标注的情况，见 `data/samples/negative/`：
- `shadow_not_crack.jpg` - 阴影不是裂缝
- `paint_not_rust.jpg` - 油漆剥落不是锈蚀
- `design_curve_not_deformation.jpg` - 设计曲线不是变形
- 等

---

## 📊 标注流程

### 1. 准备阶段
1. 阅读本规范文档
2. 观看标注培训视频（如有）
3. 完成 10-20 张样例图的测试标注
4. 通过质检员审核（准确率 ≥ 85%）

### 2. 标注阶段
1. 使用统一的标注工具（推荐：LabelImg、CVAT、Labelme）
2. 按类别顺序逐一标注（避免遗漏）
3. 每完成 50 张提交一次质检
4. 根据反馈及时调整

### 3. 质检阶段
1. 质检员抽检 20% 标注结果
2. 计算 IoU 和类别准确率
3. 不合格标注退回重做
4. 记录常见错误并反馈

### 4. 审核阶段
1. 资深标注员或工程师终审
2. 解决分歧案例
3. 更新难例库
4. 归档最终数据集

---

## 🔧 工具与格式

### 推荐标注工具
- **LabelImg**: 简单易用，支持 YOLO 格式
- **CVAT**: 在线协作，适合团队
- **Labelme**: 支持多边形，灵活度高

### 输出格式
- **格式**: YOLO 格式（每张图对应一个 `.txt` 文件）
- **示例**:
  ```
  0 0.5 0.3 0.2 0.15   # class_id center_x center_y width height（归一化坐标）
  1 0.7 0.6 0.1 0.08
  ```
- **坐标说明**: 所有坐标值归一化到 [0, 1] 范围

---

## ⚠️ 常见错误与纠正

### 错误 1: bbox 过大
- **表现**: 包含大量背景区域
- **纠正**: 紧贴目标边缘，留白 < 5%

### 错误 2: 遗漏小目标
- **表现**: 细裂缝、小锈点未标注
- **纠正**: 放大图像仔细检查

### 错误 3: 类别混淆
- **表现**: 锈蚀标为腐蚀、剥落标为裂缝
- **纠正**: 参考类别特征，必要时咨询

### 错误 4: 重复标注
- **表现**: 同一目标被标注多次
- **纠正**: 检查标注列表，删除重复项

### 错误 5: 边界不准
- **表现**: bbox 边缘偏移 > 10%
- **纠正**: 使用缩放工具精细调整

---

## 📞 支持与反馈

- **技术支持**: vision-team@example.com
- **标注疑问**: annotation-support@example.com
- **规范更新**: 提交 Issue 或 PR

---

## 📚 附录

### A. 术语表
- **IoU (Intersection over Union)**: 预测框与真实框的交并比
- **bbox (Bounding Box)**: 边界框，矩形标注框
- **归一化坐标**: 坐标值除以图像宽高，范围 [0,1]

### B. 参考资料
- YOLO 标注格式说明: https://github.com/ultralytics/yolov5/wiki
- 桥梁病害分类标准: GB/T XXXXX-XXXX
- 混凝土结构检测规范: JGJ/T XXXXX-XXXX

### C. 版本变更记录
| 版本 | 日期 | 变更内容 | 责任人 |
|-----|------|---------|--------|
| v1.0 | 2025-12-17 | 初始版本，定义 5 类病害 | Team |

---

**重要提示**: 本规范为活文档，将根据实际标注经验持续优化。所有变更需经团队评审并更新版本号。
